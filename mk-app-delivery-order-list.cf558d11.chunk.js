webpackJsonp([10],{1828:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i,o,a=n(2),u=r(a),c=n(46),d=r(c),f=n(5),s=r(f),l=n(10),p=r(l),m=n(8),h=r(m),v=n(9),g=r(v),y=n(0),w=(r(y),n(254)),x=n(651),A=r(x),C=(i=(0,w.wrapper)(A.default))(o=function(t){function e(){return(0,s.default)(this,e),(0,h.default)(this,(e.__proto__||(0,d.default)(e)).apply(this,arguments))}return(0,g.default)(e,t),(0,p.default)(e,[{key:"render",value:function(){return this.props.monkeyKing((0,u.default)({},this.props,{path:"root"}))}}]),e}(y.Component))||o;e.default=C,t.exports=e.default},1829:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){var e=new m.action(t),n=A.default.actionCreator((0,a.default)({},t,{metaAction:e})),r=new C((0,a.default)({},t,{metaAction:e,extendAction:n})),i=(0,a.default)({},e,n.gridAction,r);return e.config({metaHandlers:i}),i}Object.defineProperty(e,"__esModule",{value:!0});var o=n(2),a=r(o),u=n(570),c=r(u),d=n(571),f=r(d),s=n(5),l=r(s);e.default=i;var p=n(0),m=(r(p),n(254)),h=(n(72),n(585)),v=r(h),g=n(6),y=(r(g),n(11)),w=r(y),x=n(2063),A=r(x),C=function t(e){var n=this;(0,l.default)(this,t),this.onInit=function(t){var e=t.component,r=t.injections;n.extendAction.gridAction.onInit({component:e,injections:r}),n.component=e,n.injections=r,r.reduce("init");var i=n.metaAction.gf("data.pagination").toJS(),o=n.metaAction.gf("data.filter").toJS();n.load(i,o)},this.load=function(){var t=(0,f.default)(c.default.mark(function t(e,r){var i;return c.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.webapi.deliverOrderList.init({pagination:e,filter:r});case 2:i=t.sent,i.filter=r,n.injections.reduce("load",i);case 5:case"end":return t.stop()}},t,n)}));return function(e,n){return t.apply(this,arguments)}}(),this.reload=(0,f.default)(c.default.mark(function t(){var e,r;return c.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=n.metaAction.gf("data.pagination").toJS(),r=n.metaAction.gf("data.filter").toJS(),n.load(e,r);case 3:case"end":return t.stop()}},t,n)})),this.add=(0,f.default)(c.default.mark(function t(){return c.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n.config.apps["mk-app-delivery-order"]){t.next=2;break}throw"依赖mk-app-delivery-order app,请使用mk clone mk-app-delivery-order命令添加";case 2:n.component.props.setPortalContent&&n.component.props.setPortalContent("销售出库单","mk-app-delivery-order");case 3:case"end":return t.stop()}},t,n)})),this.batchMenuClick=function(t){switch(t.key){case"del":n.batchDel();break;case"audit":n.batchAudit()}},this.batchDel=(0,f.default)(c.default.mark(function t(){var e,r,i,o;return c.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if((e=n.metaAction.gf("data.list"))&&0!=e.size){t.next=4;break}return n.metaAction.toast("error","请选中要删除的记录"),t.abrupt("return");case 4:if((r=e.filter(function(t){return t.get("selected")}))&&0!=r.size){t.next=8;break}return n.metaAction.toast("error","请选中要删除的记录"),t.abrupt("return");case 8:return t.next=10,n.metaAction.modal("confirm",{title:"删除",content:"确认删除?"});case 10:if(i=t.sent){t.next=13;break}return t.abrupt("return");case 13:return o=r.map(function(t){return t.get("id")}).toJS(),t.next=16,n.webapi.deliverOrderList.del({ids:o});case 16:n.metaAction.toast("success","删除成功"),n.reload();case 18:case"end":return t.stop()}},t,n)})),this.batchAudit=(0,f.default)(c.default.mark(function t(){var e,r,i;return c.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if((e=n.metaAction.gf("data.list"))&&0!=e.size){t.next=4;break}return n.metaAction.toast("error","请选中要审核的记录"),t.abrupt("return");case 4:if((r=e.filter(function(t){return t.get("selected")}))&&0!=r.size){t.next=8;break}return n.metaAction.toast("error","请选中要审核的记录"),t.abrupt("return");case 8:return i=r.map(function(t){return t.get("id")}).toJS(),t.next=11,n.webapi.deliverOrderList.audit({ids:i});case 11:n.metaAction.toast("success","审核成功"),n.reload();case 13:case"end":return t.stop()}},t,n)})),this.audit=function(t){return(0,f.default)(c.default.mark(function e(){return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.webapi.deliverOrderList.audit({ids:[t]});case 2:n.metaAction.toast("success","审核成功"),n.reload();case 4:case"end":return e.stop()}},e,n)}))},this.reject=function(t){return(0,f.default)(c.default.mark(function e(){return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.webapi.deliverOrderList.reject({ids:[t]});case 2:n.metaAction.toast("success","反审核成功"),n.reload();case 4:case"end":return e.stop()}},e,n)}))},this.del=function(t){return(0,f.default)(c.default.mark(function e(){var r;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.metaAction.modal("confirm",{title:"删除",content:"确认删除?"});case 2:if(r=e.sent){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,n.webapi.deliverOrderList.del({ids:[t]});case 7:n.metaAction.toast("success","删除成功"),n.reload();case 9:case"end":return e.stop()}},e,n)}))},this.modify=function(t){return(0,f.default)(c.default.mark(function e(){return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.config.apps["mk-app-delivery-order"]){e.next=2;break}throw"依赖mk-app-delivery-order app,请使用mk clone mk-app-delivery-order命令添加";case 2:n.component.props.setPortalContent&&n.component.props.setPortalContent("存货卡片","mk-app-delivery-order",{deliveryOrderId:t});case 3:case"end":return e.stop()}},e,n)}))},this.toggleShowAdvanceFilter=function(){n.metaAction.sf("data.other.isFold",!n.metaAction.gf("data.other.isFold"))},this.commonFilterChange=function(){var t=(0,f.default)(c.default.mark(function t(e){var r,i,o,a;return c.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.target.value,i=n.metaAction.gf("data.pagination").toJS(),o=n.metaAction.gf("data.filter").toJS(),o.common=r,t.next=5,n.webapi.deliverOrderList.query({pagination:i,filter:o});case 5:a=t.sent,a.filter=o,n.load(i,o);case 8:case"end":return t.stop()}},t,n)}));return function(e){return t.apply(this,arguments)}}(),this.tabChange=function(){var t=(0,f.default)(c.default.mark(function t(e){var r,i,o;return c.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.metaAction.gf("data.pagination").toJS(),i=n.metaAction.gf("data.filter").toJS(),i.targetList=e,t.next=4,n.webapi.deliverOrderList.query({pagination:r,filter:i});case 4:o=t.sent,o.filter=i,n.load(r,i);case 7:case"end":return t.stop()}},t,n)}));return function(e){return t.apply(this,arguments)}}(),this.customerChange=function(t){var e=n.metaAction.gf("data.other.customers"),r=e.find(function(e){return e.get("id")==t});n.metaAction.sf("data.filter.customer",r)},this.search=function(){n.reload()},this.pageChanged=function(t,e){var r=n.metaAction.gf("data.filter").toJS();n.load({current:t,pageSize:e},r)},this.receipt=function(){throw"请实现收框功能"},this.print=function(){throw"请实现打印功能"},this.exp=function(){throw"请实现导出功能"},this.setting=function(){throw"请实现设置功能"},this.numberFormat=w.default.number.format,this.metaAction=e.metaAction,this.extendAction=e.extendAction,this.config=v.default.current,this.webapi=this.config.webapi};t.exports=e.default},1830:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){var e=new f.reducer(t),n=m.default.reducerCreator((0,a.default)({},t,{metaReducer:e})),r=new h((0,a.default)({},t,{metaReducer:e,extendReducer:n}));return(0,a.default)({},e,n.gridReducer,r)}Object.defineProperty(e,"__esModule",{value:!0});var o=n(2),a=r(o),u=n(5),c=r(u);e.default=i;var d=n(72),f=n(254),s=n(585),l=(r(s),n(652)),p=n(2063),m=r(p),h=function t(e){var n=this;(0,c.default)(this,t),this.init=function(t,e){var r=(0,l.getInitState)();return n.metaReducer.init(t,r)},this.load=function(t,e){return t=n.metaReducer.sf(t,"data.list",(0,d.fromJS)(e.list)),t=n.metaReducer.sf(t,"data.pagination",(0,d.fromJS)(e.pagination)),t=n.metaReducer.sf(t,"data.filter",(0,d.fromJS)(e.filter)),t=n.metaReducer.sf(t,"data.total",(0,d.fromJS)(e.total)),e.customers&&(t=n.metaReducer.sf(t,"data.other.customers",(0,d.fromJS)(e.customers))),t},this.metaReducer=e.metaReducer};t.exports=e.default},1966:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(1967),o=r(i),a=n(1968),u=r(a);e.default={action:o.default,reducer:u.default},t.exports=e.default},1967:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(7),o=r(i),a=n(52),u=r(a),c=n(2),d=r(c),f=n(47),s=r(f),l=n(5),p=r(l),m=n(10),h=r(m),v=n(11),g=r(v),y=n(14),w=r(y),x=function(){function t(e){var n=this;(0,p.default)(this,t),this.onInit=function(t){var e=t.component,r=t.injections;n.component=e,n.injections=r},this.isSelectAll=function(t){if(n.option){"string"==typeof t&&t||(t=(0,s.default)(n.option)[0]);var e=n.metaAction.gf(n.option[t].path);return!(!e||0==e.size)&&e.every(function(e){return e.get(n.option[t].selectFieldName)})}},this.selectAll=function(t){return function(e){n.option&&("string"==typeof t&&t||(t=(0,s.default)(n.option)[0]),n.injections.reduce("selectAll",e.target.checked,t))}},this.getSelectedCount=function(t){if(n.option){"string"==typeof t&&t||(t=(0,s.default)(n.option)[0]);var e=n.metaAction.gf(n.option[t].path);if(!e||0==e.size)return 0;return e.filter(function(e){return!!e.get(n.option[t].selectFieldName)}).size}},this.mousedown=function(t){if(n.option){var e=g.default.path.findPathByEvent(t);if(!n.metaAction.isFocus(e))if(-1!=e.indexOf("cell.cell"))n.focusCell(n.getCellInfo(e),e);else{if(!n.metaAction.focusByEvent(t))return;setTimeout(n.cellAutoFocus,16)}}},this.gridKeydown=function(t){if(n.option){var e="";if(37!=t.keyCode&&39!=t.keyCode&&13!=t.keyCode&&108!=t.keyCode&&9!=t.keyCode&&38!=t.keyCode&&40!=t.keyCode||(e=g.default.path.findPathByEvent(t))&&-1!=e.indexOf(",")){if(37==t.keyCode){if(!g.default.dom.cursorAtBegin(t))return;return void n.moveEditCell(e,"left")}if(39==t.keyCode||13==t.keyCode||108==t.keyCode||9==t.keyCode){if(!g.default.dom.cursorAtEnd(t))return;return void n.moveEditCell(e,"right")}return 38==t.keyCode?void n.moveEditCell(e,"up"):40==t.keyCode?void n.moveEditCell(e,"down"):void 0}}},this.cellAutoFocus=function(){g.default.dom.gridCellAutoFocus(n.component,".editable-cell")},this.getCellClassName=function(t,e,r){if(n.option){"string"==typeof r&&r||(r=(0,s.default)(n.option)[0]);var i=n.option[r].cellClassName,o=n.metaAction.isFocus(t)?i+" editable-cell":"";return e&&(o+=" "+i+"-"+e),o}},this.dateOpenChange=function(t){if(!t){var e=w.default.findDOMNode(n.component).querySelector(".editable-cell");if(e&&-1!=e.className.indexOf("datepicker")){e.querySelector("input").focus()}}},this.addRow=function(t){return function(e){n.injections.reduce("addRow",t,e.rowIndex+1)}},this.delRow=function(t){return function(e){n.injections.reduce("delRow",t,e.rowIndex)}},this.metaAction=e.metaAction,e.gridOption&&(this.option=e.gridOption)}return(0,h.default)(t,[{key:"getColNames",value:function(t){return this.option[t].getColNames(this.metaAction.gf)}},{key:"moveEditCell",value:function(t,e){var n=this.getCellInfo(t);this.moveCell(n,e,t)}},{key:"moveCell",value:function(t,e,n){var r=function(t,e,n){return!1},i=(0,s.default)(this.option),o=!0,a=!1,c=void 0;try{for(var f,l=(0,u.default)(i);!(o=(f=l.next()).done);o=!0){var p=f.value;-1!=n.indexOf(p)&&this.option[p].cellIsReadonly&&(r=this.option[p].cellIsReadonly)}}catch(t){a=!0,c=t}finally{try{!o&&l.return&&l.return()}finally{if(a)throw c}}var m=g.default.matrix.move(t.rowCount,t.colCount,{x:t.x,y:t.y},e);m.x===t.x&&m.y===t.y||(r(m,n,this.metaAction.gf)?this.moveCell((0,d.default)({},t,m),e,n):this.focusCell((0,d.default)({},t,m),n))}},{key:"focusCell",value:function(t,e){var n=(0,s.default)(this.option),r=!0,i=!1,a=void 0;try{for(var c,d=(0,u.default)(n);!(r=(c=d.next()).done);r=!0){var f=c.value;if(-1!=e.indexOf(f)){var l,p=this.getColPathPrefix(e,f);this.metaAction.sfs((l={"data.other.focusFieldPath":""+p+this.getColNames(f)[t.x]+".cell.cell,"+t.y},(0,o.default)(l,"data.other."+f+"ScrollToRow",t.y),(0,o.default)(l,"data.other."+f+"ScrollToColumn",t.x+1),l))}}}catch(t){i=!0,a=t}finally{try{!r&&d.return&&d.return()}finally{if(i)throw a}}setTimeout(this.cellAutoFocus,16)}},{key:"getColPathPrefix",value:function(t,e){return t.substring(0,t.indexOf(e))+e+".columns."}},{key:"getCellInfo",value:function(t){if(this.option){var e=g.default.path.parsePath(t),n=(0,s.default)(this.option),r=!0,i=!1,o=void 0;try{for(var a,c=(0,u.default)(n);!(r=(a=c.next()).done);r=!0){var d=a.value;if(-1!=t.indexOf(d)){var f=this.getColPathPrefix(t,d),l=this.metaAction.gf(this.option[d].path).size,p=this.getColNames(d).length,m=e.path.replace(f,"").replace(".cell.cell","").replace(/\s/g,"");return{x:this.getColNames(d).findIndex(function(t){return t==m}),y:Number(e.vars[0]),colCount:p,rowCount:l}}}}catch(t){i=!0,o=t}finally{try{!r&&c.return&&c.return()}finally{if(i)throw o}}}}}]),t}();e.default=x,t.exports=e.default},1968:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(5),i=function(t){return t&&t.__esModule?t:{default:t}}(r),o=n(72),a=function t(e){var n=this;(0,i.default)(this,t),this.selectAll=function(t,e,r){if(!n.option)return t;var i=n.option[r].path,o=n.option[r].selectFieldName,a=n.metaReducer.gf(t,i);if(!a||0==a.size)return t;for(var u=0;u<a.size;u++)t=n.metaReducer.sf(t,i+"."+u+"."+o,e);return t},this.addRow=function(t,e,r){if(!n.option)return t;var i=n.option[e].path,a=n.option[e].emptyRow||{},u=n.metaReducer.gf(t,i);return u=u.insert(r,(0,o.Map)(a)),n.metaReducer.sf(t,i,u)},this.delRow=function(t,e,r){if(!n.option)return t;var i=n.option[e].path,a=n.metaReducer.gf(t,i);return-1==r?t:(a=a.remove(r),0==a.size&&(a=a.insert(r,(0,o.Map)({}))),n.metaReducer.sf(t,i,a))},this.metaReducer=e.metaReducer,e.gridOption&&(this.option=e.gridOption)};e.default=a,t.exports=e.default},2063:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(){return{dataGrid:{path:"data.list",selectFieldName:"selected"}}}function o(t){return{gridAction:new f.default.action((0,c.default)({},t,{gridOption:i()}))}}function a(t){return{gridReducer:new f.default.reducer((0,c.default)({},t,{gridOption:i()}))}}Object.defineProperty(e,"__esModule",{value:!0});var u=n(2),c=r(u),d=n(1966),f=r(d);e.default={actionCreator:o,reducerCreator:a},t.exports=e.default}});