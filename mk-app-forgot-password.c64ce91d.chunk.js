webpackJsonp([15],{1630:function(t,e,r){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,u,s=r(2),c=a(s),o=r(58),i=a(o),f=r(4),p=a(f),d=r(9),l=a(d),h=r(6),m=a(h),v=r(7),k=a(v),w=r(0),x=(a(w),r(274)),b=r(629),g=a(b),P=(n=(0,x.wrapper)(g.default))(u=function(t){function e(){return(0,p.default)(this,e),(0,m.default)(this,(e.__proto__||(0,i.default)(e)).apply(this,arguments))}return(0,k.default)(e,t),(0,l.default)(e,[{key:"render",value:function(){return this.props.monkeyKing((0,c.default)({},this.props,{path:"root"}))}}]),e}(w.Component))||u;e.default=P,t.exports=e.default},1631:function(t,e,r){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function n(t){var e=new w.action(t),r=new P((0,o.default)({},t,{metaAction:e})),a=(0,o.default)({},e,r);return e.config({metaHandlers:a}),a}Object.defineProperty(e,"__esModule",{value:!0});var u=r(24),s=a(u),c=r(2),o=a(c),i=r(275),f=a(i),p=r(604),d=a(p),l=r(605),h=a(l),m=r(4),v=a(m);e.default=n;var k=r(0),w=(a(k),r(274)),x=(r(80),r(8)),b=(a(x),r(609)),g=a(b),P=function t(e){var r=this;(0,v.default)(this,t),this.onInit=function(t){var e=t.component,a=t.injections;r.component=e,r.injections=a,r.component.props.setOkListener&&r.component.props.setOkListener(r.onOk),a.reduce("init")},this.onOk=(0,h.default)(d.default.mark(function t(){return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.save();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,r)})),this.next=(0,h.default)(d.default.mark(function t(){var e,a;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=r.metaAction.gf("data.form").toJS(),t.next=3,r.check([{path:"data.form.mobile",value:e.mobile},{path:"data.form.captcha",value:e.captcha}]);case 3:if(a=t.sent){t.next=6;break}return t.abrupt("return");case 6:return t.next=8,r.webapi.captcha.validate(e.captcha);case 8:r.metaAction.sf("data.other.step",2);case 9:case"end":return t.stop()}},t,r)})),this.prev=(0,h.default)(d.default.mark(function t(){return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r.metaAction.sf("data.other.step",1);case 1:case"end":return t.stop()}},t,r)})),this.modify=(0,h.default)(d.default.mark(function t(){var e,a;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=r.metaAction.gf("data.form").toJS(),t.next=3,r.check([{path:"data.form.password",value:e.password},{path:"data.form.confirmPassword",value:e.confirmPassword}]);case 3:if(a=t.sent){t.next=6;break}return t.abrupt("return");case 6:return t.next=8,r.webapi.user.modifyPassword({mobile:e.mobile,password:e.password});case 8:r.metaAction.toast("success","重设密码成功"),r.goLogin();case 10:case"end":return t.stop()}},t,r)})),this.getLogo=function(){return r.config.logo},this.getCaptcha=(0,h.default)(d.default.mark(function t(){var e;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.webapi.captcha.fetch();case 2:e=t.sent,r.metaAction.toast("success","验证码已经发送到您的手机，请输入[模拟先输入：123456]");case 4:case"end":return t.stop()}},t,r)})),this.fieldChange=function(){var t=(0,h.default)(d.default.mark(function t(e,a){return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.check([{path:e,value:a}]);case 2:case"end":return t.stop()}},t,r)}));return function(e,r){return t.apply(this,arguments)}}(),this.goLogin=function(){if(!r.config.apps["mk-app-login"])throw"请将这个应用加入到带mk-app-root和mk-app-login的网站中，跳转功能才能正常使用";r.component.props.onRedirect&&r.config.goLogin&&r.component.props.onRedirect(r.config.goLogin)},this.check=function(){var t=(0,h.default)(d.default.mark(function t(e){var a,n,u,c,i,p,l,h,m,v,k;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:a=[],n=!0,u=!1,c=void 0,t.prev=6,i=(0,f.default)(e);case 8:if(n=(p=i.next()).done){t.next=56;break}if(l=p.value,h=(0,o.default)({},l),"data.form.mobile"!=l.path){t.next=20;break}return t.t0=s.default,t.t1=h,t.next=16,r.checkMobile(l.value);case 16:t.t2=t.sent,(0,t.t0)(t.t1,t.t2),t.next=52;break;case 20:if("data.form.captcha"!=l.path){t.next=29;break}return t.t3=s.default,t.t4=h,t.next=25,r.checkCaptcha(l.value);case 25:t.t5=t.sent,(0,t.t3)(t.t4,t.t5),t.next=52;break;case 29:if("data.form.password"!=l.path){t.next=45;break}return t.t6=s.default,t.t7=h,t.next=34,r.checkPassword(l.value);case 34:if(t.t8=t.sent,(0,t.t6)(t.t7,t.t8),!(m=r.metaAction.gf("data.form.confirmPassword"))){t.next=43;break}return t.t9=a,t.next=41,r.checkConfirmPassword(m,l.value);case 41:t.t10=t.sent,t.t9.push.call(t.t9,t.t10);case 43:t.next=52;break;case 45:if("data.form.confirmPassword"!=l.path){t.next=52;break}return t.t11=s.default,t.t12=h,t.next=50,r.checkConfirmPassword(l.value,r.metaAction.gf("data.form.password"));case 50:t.t13=t.sent,(0,t.t11)(t.t12,t.t13);case 52:a.push(h);case 53:n=!0,t.next=8;break;case 56:t.next=62;break;case 58:t.prev=58,t.t14=t.catch(6),u=!0,c=t.t14;case 62:t.prev=62,t.prev=63,!n&&i.return&&i.return();case 65:if(t.prev=65,!u){t.next=68;break}throw c;case 68:return t.finish(65);case 69:return t.finish(62);case 70:return v={},k=!0,a.forEach(function(t){v[t.path]=t.value,v[t.errorPath]=t.message,t.message&&(k=!1)}),r.metaAction.sfs(v),t.abrupt("return",k);case 75:case"end":return t.stop()}},t,r,[[6,58,62,70],[63,,65,69]])}));return function(e){return t.apply(this,arguments)}}(),this.checkMobile=function(){var t=(0,h.default)(d.default.mark(function t(e){var a;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=4;break}a="请录入手机号",t.next=13;break;case 4:if(/^1[3|4|5|8][0-9]\d{8}$/.test(e)){t.next=8;break}a="请录入有效的手机号",t.next=13;break;case 8:return t.next=10,r.webapi.user.existsMobile(e);case 10:if(t.t0=t.sent,0!=t.t0){t.next=13;break}a="该手机号未注册";case 13:return t.abrupt("return",{errorPath:"data.other.error.mobile",message:a});case 14:case"end":return t.stop()}},t,r)}));return function(e){return t.apply(this,arguments)}}(),this.checkCaptcha=function(){var t=(0,h.default)(d.default.mark(function t(e){var a;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e||(a="请录入验证码"),t.abrupt("return",{errorPath:"data.other.error.captcha",message:a});case 2:case"end":return t.stop()}},t,r)}));return function(e){return t.apply(this,arguments)}}(),this.checkPassword=function(){var t=(0,h.default)(d.default.mark(function t(e){var a;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e||(a="请录入密码"),t.abrupt("return",{errorPath:"data.other.error.password",message:a});case 2:case"end":return t.stop()}},t,r)}));return function(e){return t.apply(this,arguments)}}(),this.checkConfirmPassword=function(){var t=(0,h.default)(d.default.mark(function t(e,a){var n;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e?a!=e&&(n="两次密码输入不一致，请确认"):n="请录入确认密码",t.abrupt("return",{errorPath:"data.other.error.confirmPassword",message:n});case 2:case"end":return t.stop()}},t,r)}));return function(e,r){return t.apply(this,arguments)}}(),this.metaAction=e.metaAction,this.config=g.default.current,this.webapi=this.config.webapi};t.exports=e.default},1632:function(t,e,r){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function n(t){var e=new d.reducer(t),r=new v((0,i.default)({},t,{metaReducer:e}));return(0,i.default)({},e,r)}Object.defineProperty(e,"__esModule",{value:!0});var u,s,c,o=r(2),i=a(o),f=r(4),p=a(f);e.default=n;var d=(r(80),r(274)),l=r(609),h=(a(l),r(8)),m=(a(h),r(630)),v=(s=u=function t(e){(0,p.default)(this,t),c.call(this),this.metaReducer=e.metaReducer},c=function(){var t=this;this.init=function(e,r){return t.metaReducer.init(e,(0,m.getInitState)(r))}},s);t.exports=e.default}});